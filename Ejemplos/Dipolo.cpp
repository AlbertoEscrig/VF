// =================================================================================================
// ====================================================================================== Dipolo.cpp
//
// Campo electrostático alrededor de dos cilindros paralelos con carga opuesta
//
// ================================================================= Copyright © 2025 Alberto Escrig
// =================================================================================================

import VF;
import std;

// -------------------------------------------------------------------------------------- Constantes

constexpr std::size_t NCorNoOrto = 5u;

int main()
{
// ------------------------------------------------------------------------------------------- Malla

VF::TMalla2D::Read("Dipolo.msh");

// ------------------------------------------------------------------------------------------ Campos

VF::TCampoEscalar2D V;
VF::TCampoVectorial2D E;

// ------------------------------------------------------------------------- Condiciones de contorno

V.DefCC<VF::TDirichlet>("positive",  1.0);
V.DefCC<VF::TDirichlet>("negative", -1.0);

// ---------------------------------------------------------------------------------------- Solución

for (std::size_t i = 0u; i < NCorNoOrto; ++i)
  solve(lap(V) == 0, V);

E = -grad(V);

// -------------------------------------------------------------------------------------- Resultados

std::ofstream ofs("resu.vtk");

VF::TMalla2D::Write(ofs);
V.Write(ofs, "V");
E.Write(ofs, "E");

return 0;
}
